<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: EventFlowComponents Pages: 1 -->
<svg width="2665pt" height="277pt"
 viewBox="0.00 0.00 2664.50 276.92" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 272.92)">
<title>EventFlowComponents</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-272.92 2660.5,-272.92 2660.5,4 -4,4"/>
<text text-anchor="middle" x="1328.25" y="-253.52" font-family="Helvetica,sans-Serif" font-size="12.00">PinballCTL Event Flow and Components</text>
<!-- UI -->
<g id="node1" class="node">
<title>UI</title>
<path fill="#eef3ff" stroke="#2f3b52" d="M196.38,-109C196.38,-109 22.13,-109 22.13,-109 16.12,-109 10.13,-103 10.13,-97 10.13,-97 10.13,-85 10.13,-85 10.13,-79 16.13,-73 22.13,-73 22.13,-73 196.38,-73 196.38,-73 202.38,-73 208.38,-79 208.38,-85 208.38,-85 208.38,-97 208.38,-97 208.38,-103 202.38,-109 196.38,-109"/>
<text text-anchor="middle" x="109.25" y="-86.55" font-family="Helvetica,sans-Serif" font-size="11.00">Playfield UI\n(button click / key press)</text>
</g>
<!-- API -->
<g id="node3" class="node">
<title>API</title>
<path fill="#eef3ff" stroke="#2f3b52" d="M362.25,-82C362.25,-82 267.5,-82 267.5,-82 261.5,-82 255.5,-76 255.5,-70 255.5,-70 255.5,-58 255.5,-58 255.5,-52 261.5,-46 267.5,-46 267.5,-46 362.25,-46 362.25,-46 368.25,-46 374.25,-52 374.25,-58 374.25,-58 374.25,-70 374.25,-70 374.25,-76 368.25,-82 362.25,-82"/>
<text text-anchor="middle" x="314.88" y="-59.55" font-family="Helvetica,sans-Serif" font-size="11.00">POST /api/events/fire</text>
</g>
<!-- UI&#45;&gt;API -->
<g id="edge1" class="edge">
<title>UI&#45;&gt;API</title>
<path fill="none" stroke="#3b4d73" d="M208.78,-77.93C220.66,-76.36 232.6,-74.78 243.95,-73.27"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="244.12,-76.78 253.57,-72 243.2,-69.84 244.12,-76.78"/>
</g>
<!-- EXT -->
<g id="node2" class="node">
<title>EXT</title>
<path fill="#eef3ff" stroke="#2f3b52" d="M206.5,-55C206.5,-55 12,-55 12,-55 6,-55 0,-49 0,-43 0,-43 0,-31 0,-31 0,-25 6,-19 12,-19 12,-19 206.5,-19 206.5,-19 212.5,-19 218.5,-25 218.5,-31 218.5,-31 218.5,-43 218.5,-43 218.5,-49 212.5,-55 206.5,-55"/>
<text text-anchor="middle" x="109.25" y="-32.55" font-family="Helvetica,sans-Serif" font-size="11.00">External Pi app\n(movie, payment, scripts)</text>
</g>
<!-- EXT&#45;&gt;API -->
<g id="edge2" class="edge">
<title>EXT&#45;&gt;API</title>
<path fill="none" stroke="#3b4d73" d="M218.92,-51.41C227.36,-52.53 235.73,-53.64 243.81,-54.71"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="243.14,-58.15 253.51,-56 244.06,-51.21 243.14,-58.15"/>
</g>
<!-- V -->
<g id="node4" class="node">
<title>V</title>
<path fill="#eef3ff" stroke="#2f3b52" d="M588.5,-147C588.5,-147 423.25,-147 423.25,-147 417.25,-147 411.25,-141 411.25,-135 411.25,-135 411.25,-123 411.25,-123 411.25,-117 417.25,-111 423.25,-111 423.25,-111 588.5,-111 588.5,-111 594.5,-111 600.5,-117 600.5,-123 600.5,-123 600.5,-135 600.5,-135 600.5,-141 594.5,-147 588.5,-147"/>
<text text-anchor="middle" x="505.88" y="-124.55" font-family="Helvetica,sans-Serif" font-size="11.00">Validate event\n(registry + mapping)</text>
</g>
<!-- API&#45;&gt;V -->
<g id="edge3" class="edge">
<title>API&#45;&gt;V</title>
<path fill="none" stroke="#3b4d73" d="M369.53,-82.45C391.58,-90.03 417.29,-98.88 440.35,-106.81"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="439.06,-110.07 449.66,-110.01 441.34,-103.45 439.06,-110.07"/>
</g>
<!-- BR_ENQ -->
<g id="node10" class="node">
<title>BR_ENQ</title>
<path fill="#eef3ff" stroke="#2f3b52" d="M1754,-144C1754,-144 1613.5,-144 1613.5,-144 1607.5,-144 1601.5,-138 1601.5,-132 1601.5,-132 1601.5,-120 1601.5,-120 1601.5,-114 1607.5,-108 1613.5,-108 1613.5,-108 1754,-108 1754,-108 1760,-108 1766,-114 1766,-120 1766,-120 1766,-132 1766,-132 1766,-138 1760,-144 1754,-144"/>
<text text-anchor="middle" x="1683.75" y="-121.55" font-family="Helvetica,sans-Serif" font-size="11.00">Bridge enqueue EVENT_FIRE</text>
</g>
<!-- API&#45;&gt;BR_ENQ -->
<g id="edge11" class="edge">
<title>API&#45;&gt;BR_ENQ</title>
<path fill="none" stroke="#3b4d73" d="M374.62,-64C411.93,-64 461.23,-64 504.88,-64 504.88,-64 504.88,-64 1461.12,-64 1521.47,-64 1587.76,-85.58 1631.97,-103.28"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="1630.46,-106.44 1641.04,-106.99 1633.11,-99.97 1630.46,-106.44"/>
</g>
<!-- ELOG_PI -->
<g id="node14" class="node">
<title>ELOG_PI</title>
<path fill="#f9f2ff" stroke="#6d3f90" d="M548.75,-36C548.75,-36 463,-36 463,-36 457,-36 451,-30 451,-24 451,-24 451,-12 451,-12 451,-6 457,0 463,0 463,0 548.75,0 548.75,0 554.75,0 560.75,-6 560.75,-12 560.75,-12 560.75,-24 560.75,-24 560.75,-30 554.75,-36 548.75,-36"/>
<text text-anchor="middle" x="505.88" y="-13.55" font-family="Helvetica,sans-Serif" font-size="11.00">events.log\npi&#45;&gt;esp</text>
</g>
<!-- API&#45;&gt;ELOG_PI -->
<g id="edge17" class="edge">
<title>API&#45;&gt;ELOG_PI</title>
<path fill="none" stroke="#3b4d73" d="M374.64,-49.7C395.22,-44.69 418.44,-39.04 439.52,-33.91"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="440.29,-37.32 449.18,-31.56 438.64,-30.52 440.29,-37.32"/>
</g>
<!-- BUS -->
<g id="node5" class="node">
<title>BUS</title>
<path fill="#f4f8ea" stroke="#3e6a2b" d="M727,-166C727,-166 649.5,-166 649.5,-166 643.5,-166 637.5,-160 637.5,-154 637.5,-154 637.5,-142 637.5,-142 637.5,-136 643.5,-130 649.5,-130 649.5,-130 727,-130 727,-130 733,-130 739,-136 739,-142 739,-142 739,-154 739,-154 739,-160 733,-166 727,-166"/>
<text text-anchor="middle" x="688.25" y="-143.55" font-family="Helvetica,sans-Serif" font-size="11.00">Pi Event Bus emit</text>
</g>
<!-- V&#45;&gt;BUS -->
<g id="edge4" class="edge">
<title>V&#45;&gt;BUS</title>
<path fill="none" stroke="#3b4d73" d="M600.76,-138.89C609.26,-139.78 617.71,-140.67 625.81,-141.53"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="625.19,-144.98 635.5,-142.55 625.92,-138.02 625.19,-144.98"/>
</g>
<!-- SSE -->
<g id="node6" class="node">
<title>SSE</title>
<path fill="#f4f8ea" stroke="#3e6a2b" d="M956.25,-220C956.25,-220 788,-220 788,-220 782,-220 776,-214 776,-208 776,-208 776,-196 776,-196 776,-190 782,-184 788,-184 788,-184 956.25,-184 956.25,-184 962.25,-184 968.25,-190 968.25,-196 968.25,-196 968.25,-208 968.25,-208 968.25,-214 962.25,-220 956.25,-220"/>
<text text-anchor="middle" x="872.12" y="-197.55" font-family="Helvetica,sans-Serif" font-size="11.00">SSE /api/events/stream\nUI listeners</text>
</g>
<!-- BUS&#45;&gt;SSE -->
<g id="edge5" class="edge">
<title>BUS&#45;&gt;SSE</title>
<path fill="none" stroke="#3b4d73" d="M739.19,-163.78C751.22,-167.52 764.06,-171.45 776,-175 782.06,-176.8 788.35,-178.65 794.67,-180.48"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="793.27,-183.72 803.85,-183.13 795.22,-177 793.27,-183.72"/>
</g>
<!-- PEM -->
<g id="node7" class="node">
<title>PEM</title>
<path fill="#f4f8ea" stroke="#3e6a2b" d="M932.62,-166C932.62,-166 811.62,-166 811.62,-166 805.62,-166 799.62,-160 799.62,-154 799.62,-154 799.62,-142 799.62,-142 799.62,-136 805.62,-130 811.62,-130 811.62,-130 932.62,-130 932.62,-130 938.62,-130 944.62,-136 944.62,-142 944.62,-142 944.62,-154 944.62,-154 944.62,-160 938.62,-166 932.62,-166"/>
<text text-anchor="middle" x="872.12" y="-143.55" font-family="Helvetica,sans-Serif" font-size="11.00">Pi Event Manager dispatch</text>
</g>
<!-- BUS&#45;&gt;PEM -->
<g id="edge6" class="edge">
<title>BUS&#45;&gt;PEM</title>
<path fill="none" stroke="#3b4d73" d="M739.43,-148C754.47,-148 771.38,-148 787.94,-148"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="787.81,-151.5 797.81,-148 787.81,-144.5 787.81,-151.5"/>
</g>
<!-- RULES -->
<g id="node8" class="node">
<title>RULES</title>
<path fill="#eef3ff" stroke="#2f3b52" d="M1230.5,-166C1230.5,-166 1017.25,-166 1017.25,-166 1011.25,-166 1005.25,-160 1005.25,-154 1005.25,-154 1005.25,-142 1005.25,-142 1005.25,-136 1011.25,-130 1017.25,-130 1017.25,-130 1230.5,-130 1230.5,-130 1236.5,-130 1242.5,-136 1242.5,-142 1242.5,-142 1242.5,-154 1242.5,-154 1242.5,-160 1236.5,-166 1230.5,-166"/>
<text text-anchor="middle" x="1123.88" y="-143.55" font-family="Helvetica,sans-Serif" font-size="11.00">Rules evaluation\n(rules.json / rules.pd model)</text>
</g>
<!-- PEM&#45;&gt;RULES -->
<g id="edge7" class="edge">
<title>PEM&#45;&gt;RULES</title>
<path fill="none" stroke="#3b4d73" d="M945.03,-148C960.25,-148 976.76,-148 993.38,-148"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="993.37,-151.5 1003.37,-148 993.37,-144.5 993.37,-151.5"/>
</g>
<!-- DERIVED -->
<g id="node9" class="node">
<title>DERIVED</title>
<path fill="#eef3ff" stroke="#2f3b52" d="M1552.5,-144C1552.5,-144 1367.75,-144 1367.75,-144 1361.75,-144 1355.75,-138 1355.75,-132 1355.75,-132 1355.75,-120 1355.75,-120 1355.75,-114 1361.75,-108 1367.75,-108 1367.75,-108 1552.5,-108 1552.5,-108 1558.5,-108 1564.5,-114 1564.5,-120 1564.5,-120 1564.5,-132 1564.5,-132 1564.5,-138 1558.5,-144 1552.5,-144"/>
<text text-anchor="middle" x="1460.12" y="-121.55" font-family="Helvetica,sans-Serif" font-size="11.00">Derived event\n(e.g. GAME_STARTED)</text>
</g>
<!-- RULES&#45;&gt;DERIVED -->
<g id="edge8" class="edge">
<title>RULES&#45;&gt;DERIVED</title>
<path fill="none" stroke="#3b4d73" d="M1242.72,-140.24C1275.59,-138.08 1311.25,-135.73 1343.96,-133.58"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="1344.14,-137.08 1353.89,-132.93 1343.68,-130.09 1344.14,-137.08"/>
<text text-anchor="middle" x="1299.12" y="-140.72" font-family="Helvetica,sans-Serif" font-size="10.00">emit_event action</text>
</g>
<!-- DERIVED&#45;&gt;BUS -->
<g id="edge9" class="edge">
<title>DERIVED&#45;&gt;BUS</title>
<path fill="none" stroke="#3b4d73" d="M1355.28,-123.12C1319.54,-122.25 1279.27,-121.42 1242.5,-121 1035.18,-118.61 980.98,-89.84 776,-121 767.45,-122.3 758.58,-124.28 749.92,-126.59"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="749.22,-123.15 740.56,-129.26 751.14,-129.89 749.22,-123.15"/>
</g>
<!-- DERIVED&#45;&gt;BR_ENQ -->
<g id="edge10" class="edge">
<title>DERIVED&#45;&gt;BR_ENQ</title>
<path fill="none" stroke="#3b4d73" d="M1564.8,-126C1573.07,-126 1581.39,-126 1589.58,-126"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="1589.54,-129.5 1599.54,-126 1589.54,-122.5 1589.54,-129.5"/>
</g>
<!-- BR_TX -->
<g id="node11" class="node">
<title>BR_TX</title>
<path fill="#eef3ff" stroke="#2f3b52" d="M1972.75,-166C1972.75,-166 1815,-166 1815,-166 1809,-166 1803,-160 1803,-154 1803,-154 1803,-142 1803,-142 1803,-136 1809,-130 1815,-130 1815,-130 1972.75,-130 1972.75,-130 1978.75,-130 1984.75,-136 1984.75,-142 1984.75,-142 1984.75,-154 1984.75,-154 1984.75,-160 1978.75,-166 1972.75,-166"/>
<text text-anchor="middle" x="1893.88" y="-143.55" font-family="Helvetica,sans-Serif" font-size="11.00">Bridge daemon TX\nframed JSON</text>
</g>
<!-- BR_ENQ&#45;&gt;BR_TX -->
<g id="edge12" class="edge">
<title>BR_ENQ&#45;&gt;BR_TX</title>
<path fill="none" stroke="#3b4d73" d="M1766.41,-134.63C1774.55,-135.49 1782.89,-136.37 1791.2,-137.25"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="1790.69,-140.72 1801,-138.29 1791.42,-133.76 1790.69,-140.72"/>
</g>
<!-- ESP -->
<g id="node12" class="node">
<title>ESP</title>
<path fill="#fff3e8" stroke="#8a4b12" d="M2173.5,-166C2173.5,-166 2033.75,-166 2033.75,-166 2027.75,-166 2021.75,-160 2021.75,-154 2021.75,-154 2021.75,-142 2021.75,-142 2021.75,-136 2027.75,-130 2033.75,-130 2033.75,-130 2173.5,-130 2173.5,-130 2179.5,-130 2185.5,-136 2185.5,-142 2185.5,-142 2185.5,-154 2185.5,-154 2185.5,-160 2179.5,-166 2173.5,-166"/>
<text text-anchor="middle" x="2103.62" y="-143.55" font-family="Helvetica,sans-Serif" font-size="11.00">ESP runtime / protocol handler</text>
</g>
<!-- BR_TX&#45;&gt;ESP -->
<g id="edge13" class="edge">
<title>BR_TX&#45;&gt;ESP</title>
<path fill="none" stroke="#3b4d73" d="M1985.09,-148C1993.37,-148 2001.77,-148 2010.07,-148"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="2009.8,-151.5 2019.8,-148 2009.8,-144.5 2009.8,-151.5"/>
</g>
<!-- BR_RX -->
<g id="node13" class="node">
<title>BR_RX</title>
<path fill="#eef3ff" stroke="#2f3b52" d="M2497.75,-212C2497.75,-212 2328.75,-212 2328.75,-212 2322.75,-212 2316.75,-206 2316.75,-200 2316.75,-200 2316.75,-188 2316.75,-188 2316.75,-182 2322.75,-176 2328.75,-176 2328.75,-176 2497.75,-176 2497.75,-176 2503.75,-176 2509.75,-182 2509.75,-188 2509.75,-188 2509.75,-200 2509.75,-200 2509.75,-206 2503.75,-212 2497.75,-212"/>
<text text-anchor="middle" x="2413.25" y="-189.55" font-family="Helvetica,sans-Serif" font-size="11.00">Bridge daemon RX\n(EVT / EVENT)</text>
</g>
<!-- ESP&#45;&gt;BR_RX -->
<g id="edge14" class="edge">
<title>ESP&#45;&gt;BR_RX</title>
<path fill="none" stroke="#3b4d73" d="M2185.65,-154.61C2220.57,-157.99 2261.79,-162.68 2298.75,-168.75 2306.76,-170.07 2315.06,-171.59 2323.35,-173.23"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="2322.65,-176.66 2333.15,-175.22 2324.04,-169.8 2322.65,-176.66"/>
<text text-anchor="middle" x="2251.12" y="-170.5" font-family="Helvetica,sans-Serif" font-size="10.00">EVT / EVENT framed</text>
</g>
<!-- BR_RX&#45;&gt;BUS -->
<g id="edge15" class="edge">
<title>BR_RX&#45;&gt;BUS</title>
<path fill="none" stroke="#3b4d73" d="M2346.23,-212.43C2284.33,-228.08 2188.94,-248 2104.62,-248 871.12,-248 871.12,-248 871.12,-248 828.01,-248 814.36,-248.68 776,-229 750.32,-215.82 726.77,-192.81 710.71,-174.68"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="713.61,-172.68 704.43,-167.38 708.3,-177.24 713.61,-172.68"/>
</g>
<!-- BR_RX&#45;&gt;PEM -->
<g id="edge16" class="edge">
<title>BR_RX&#45;&gt;PEM</title>
<path fill="none" stroke="#3b4d73" d="M2316.3,-194C2255.61,-194 2175.52,-194 2104.62,-194 1122.88,-194 1122.88,-194 1122.88,-194 1063.44,-194 997.35,-181.24 948.09,-169.17"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="949.23,-165.85 938.68,-166.81 947.53,-172.64 949.23,-165.85"/>
</g>
<!-- ELOG_ESP -->
<g id="node15" class="node">
<title>ELOG_ESP</title>
<path fill="#f9f2ff" stroke="#6d3f90" d="M2644.5,-212C2644.5,-212 2558.75,-212 2558.75,-212 2552.75,-212 2546.75,-206 2546.75,-200 2546.75,-200 2546.75,-188 2546.75,-188 2546.75,-182 2552.75,-176 2558.75,-176 2558.75,-176 2644.5,-176 2644.5,-176 2650.5,-176 2656.5,-182 2656.5,-188 2656.5,-188 2656.5,-200 2656.5,-200 2656.5,-206 2650.5,-212 2644.5,-212"/>
<text text-anchor="middle" x="2601.62" y="-189.55" font-family="Helvetica,sans-Serif" font-size="11.00">events.log\nesp&#45;&gt;pi</text>
</g>
<!-- BR_RX&#45;&gt;ELOG_ESP -->
<g id="edge18" class="edge">
<title>BR_RX&#45;&gt;ELOG_ESP</title>
<path fill="none" stroke="#3b4d73" d="M2510.17,-194C2518.65,-194 2527.11,-194 2535.26,-194"/>
<polygon fill="#3b4d73" stroke="#3b4d73" points="2535.02,-197.5 2545.02,-194 2535.02,-190.5 2535.02,-197.5"/>
</g>
</g>
</svg>
